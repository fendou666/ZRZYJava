package com.orcle.J20170330;

import java.sql.Connection;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

public class In1StudentDao extends In1BaseDao {
	public List<In1Student> selectStudent() throws Exception{
		ResultSet sSet = null;
		ArrayList<In1Student> stuAry = new ArrayList<In1Student>();
		String sql = "SELECT * FROM student";
		Connection conn = this.getConnection();
		sSet = this.select(conn, sql);
		
		ResultSetMetaData rsmd = sSet.getMetaData();
		
		while(){
			
		}
		
		
		In1Student s =null;
		while(sSet.next()){
			s = new In1Student(sSet.getInt(1), sSet.getString(2), 
					sSet.getString(4), sSet.getString(4));
			stuAry.add(s);
		}
		this.closeConnection(conn);
		return stuAry;
	}
	public int insterStudent(In1Student s) throws Exception{
		
		String sql = "INSERT INTO studentJdba VALUES("
				+ s.getStuid()
				+ ",'" + s.getName()
				+ "','" + s.getSex()
				+ "','" + s.getClassName()
				+ "')";
		System.out.println(sql);
		Connection conn = this.getConnection();
		int count = this.update(conn, sql);
		this.closeConnection(conn);
		return count;
	}
	
	public int updateStudent(In1Student s) throws Exception{
		String sql = "UPDATE studentJdba SET stuid="+s.getStuid()
				+ ", name='" + s.getName()
				+ "', sex='" + s.getSex()
				+ "', className='" + s.getClassName()
				+ "' WHERE stuid="+ s.getStuid();
		System.out.println(sql);
		Connection conn = this.getConnection();
		int count = this.update(conn, sql);
		this.closeConnection(conn);
		return count;
	}
	public int deleteStudent(In1Student s) throws Exception{
		
		String sql = "DELETE FROM studentJdba WHERE stuid="+s.getStuid();
		System.out.println(sql);
		Connection conn = this.getConnection();
		int count = this.update(conn, sql);
		this.closeConnection(conn);
		return count;
	}
	
}
